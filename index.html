<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DemoStore - E-Commerce Testing Platform</title>
    <meta name="description" content="E-Commerce demo store for practicing Selenium test automation with features like user authentication, product catalog, cart, and checkout process.">
    <meta name="keywords" content="selenium testing, e-commerce testing, automation practice, test demo store">

    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:title" content="E-Commerce Demo Store for Selenium Testing">
    <meta property="og:description" content="Comprehensive e-commerce platform designed for practicing Selenium automation testing.">
    <meta property="og:image" content="https://demo-store.upcode.in/images/header-image.svg">
    <meta property="og:url" content="https://demo-store.upcode.in">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="E-Commerce Demo Store for Selenium Testing">
    <meta name="twitter:description" content="Practice Selenium automation testing with a complete e-commerce environment.">
    <meta name="twitter:image" content="https://demo-store.upcode.in/images/header-image.svg">

    <link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        .btn {
            display: inline-block;
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }
        
        .btn:hover {
            opacity: 0.85;
        }
        
        /* Header Styles */
        header {
            background-color: var(--dark-color);
            color: white;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: white;
            text-decoration: none;
        }
        
        .search-bar {
            flex: 1;
            margin: 0 20px;
            position: relative;
        }
        
        .search-bar input {
            width: 100%;
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .search-btn {
            position: absolute;
            right: 5px;
            top: 5px;
            background: none;
            border: none;
            cursor: pointer;
            color: #555;
        }
        
        .nav-links {
            display: flex;
            align-items: center;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            margin-left: 15px;
            position: relative;
        }
        
        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--danger-color);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }
        
        /* Authentication Forms */
        .auth-container {
            max-width: 400px;
            margin: 50px auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .auth-title {
            text-align: center;
            margin-bottom: 20px;
            color: var(--dark-color);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .form-group input {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .auth-links {
            margin-top: 15px;
            text-align: center;
        }
        
        .auth-links a {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        .auth-error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
            display: none;
        }
        
        /* Product Catalog */
        .products-container {
            margin: 30px 0;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .product-card {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
        }
        
        .product-image {
            height: 180px;
            overflow: hidden;
        }
        
        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }
        
        .product-card:hover .product-image img {
            transform: scale(1.05);
        }
        
        .product-info {
            padding: 15px;
        }
        
        .product-name {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 16px;
        }
        
        .product-price {
            color: var(--dark-color);
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .product-actions {
            display: flex;
            justify-content: space-between;
        }
        
        /* Product Detail */
        .product-detail {
            display: flex;
            flex-wrap: wrap;
            margin: 30px 0;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .product-detail-image {
            flex: 1;
            min-width: 300px;
        }
        
        .product-detail-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .product-detail-info {
            flex: 1;
            min-width: 300px;
            padding: 30px;
        }
        
        .product-detail-name {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .product-detail-price {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark-color);
            margin-bottom: 15px;
        }
        
        .product-detail-description {
            margin-bottom: 20px;
            line-height: 1.7;
        }
        
        .product-detail-meta {
            margin-bottom: 20px;
        }
        
        .meta-item {
            margin-bottom: 8px;
        }
        
        .meta-label {
            font-weight: 600;
            margin-right: 5px;
        }
        
        /* Shopping Cart */
        .cart-container {
            margin: 30px 0;
        }
        
        .cart-items {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .cart-item {
            display: flex;
            border-bottom: 1px solid #eee;
            padding: 15px;
        }
        
        .cart-item:last-child {
            border-bottom: none;
        }
        
        .cart-item-image {
            width: 100px;
            height: 100px;
            overflow: hidden;
            border-radius: 4px;
        }
        
        .cart-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .cart-item-details {
            flex: 1;
            padding: 0 15px;
        }
        
        .cart-item-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .cart-item-price {
            color: var(--dark-color);
            font-weight: 600;
        }
        
        .cart-item-actions {
            display: flex;
            align-items: center;
        }
        
        .quantity-control {
            display: flex;
            align-items: center;
            margin-right: 15px;
        }
        
        .quantity-btn {
            background-color: #eee;
            border: none;
            width: 25px;
            height: 25px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }
        
        .quantity-input {
            width: 40px;
            text-align: center;
            border: 1px solid #eee;
            height: 25px;
            margin: 0 5px;
        }
        
        .cart-summary {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-top: 20px;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .summary-item.total {
            font-weight: 700;
            font-size: 18px;
            border-top: 1px solid #eee;
            padding-top: 10px;
            margin-top: 10px;
        }
        
        /* Checkout */
        .checkout-container {
            display: flex;
            flex-wrap: wrap;
            margin: 30px 0;
            gap: 20px;
        }
        
        .checkout-form {
            flex: 2;
            min-width: 300px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        
        .checkout-summary {
            flex: 1;
            min-width: 300px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        
        .checkout-form-section {
            margin-bottom: 20px;
        }
        
        .section-title {
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 30px;
        }
        
        .page-item {
            margin: 0 5px;
        }
        
        .page-link {
            display: block;
            padding: 8px 12px;
            border-radius: 4px;
            background-color: white;
            color: var(--dark-color);
            text-decoration: none;
            transition: all 0.3s;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }
        
        .page-link:hover, .page-link.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        /* Filters */
        .filters {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .filter-group {
            margin-bottom: 15px;
        }
        
        .filter-title {
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .price-range {
            display: flex;
            gap: 10px;
        }
        
        .price-input {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 4px;
            background-color: white;
            color: #333;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            transform: translateX(150%);
            transition: transform 0.3s;
            z-index: 1000;
        }
        
        .notification.success {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .notification.error {
            background-color: var(--danger-color);
            color: white;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 50px 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .empty-icon {
            font-size: 50px;
            color: #ddd;
            margin-bottom: 20px;
        }
        
        .empty-message {
            font-size: 18px;
            color: #777;
            margin-bottom: 20px;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .header-container {
                flex-wrap: wrap;
            }
            
            .search-bar {
                order: 3;
                margin: 15px 0 0;
                width: 100%;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .nav-links {
                position: fixed;
                top: 61px;
                left: 0;
                background-color: var(--dark-color);
                width: 100%;
                padding: 20px;
                flex-direction: column;
                align-items: flex-start;
                transform: translateX(-100%);
                transition: transform 0.3s;
                z-index: 99;
            }
            
            .nav-links.active {
                transform: translateX(0);
            }
            
            .nav-links a {
                margin: 10px 0;
            }
            
            .product-detail {
                flex-direction: column;
            }
            
            .cart-item {
                flex-wrap: wrap;
            }
            
            .cart-item-actions {
                width: 100%;
                margin-top: 15px;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header>
        <div class="container header-container">
            <a href="#" class="logo" id="logo-link">DemoStore</a>
            
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="Search products...">
                <button class="search-btn" id="search-btn">
                    <i class="fas fa-search"></i>
                </button>
            </div>
            
            <button class="mobile-menu-btn" id="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="nav-links" id="nav-links">
                <a href="#" class="home-link">Home</a>
                <a href="#" id="cart-link">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-count" id="cart-count">0</span>
                </a>
                <a href="#" id="account-link">
                    <i class="fas fa-user"></i>
                </a>
            </div>
        </div>
    </header>
    
    <!-- Main Content Area -->
    <main class="container" id="main-content">
        <!-- Content will be dynamically loaded here -->
    </main>
    
    <!-- Notification -->
    <div class="notification" id="notification"></div>
    
    <script>
        // DOM Elements
        const mainContent = document.getElementById('main-content');
        const navLinks = document.getElementById('nav-links');
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const cartCountElement = document.getElementById('cart-count');
        const notification = document.getElementById('notification');
        const logoLink = document.getElementById('logo-link');
        const homeLinks = document.getElementsByClassName('home-link');
        const cartLink = document.getElementById('cart-link');
        const accountLink = document.getElementById('account-link');
        const searchInput = document.getElementById('search-input');
        const searchBtn = document.getElementById('search-btn');
        
        // App State
        let currentPage = 'home';
        let isLoggedIn = false;
        let currentUser = null;
        let products = [];
        let cart = [];
        let currentProductPage = 1;
        let productsPerPage = 5;
        let filteredProducts = [];
        let searchTerm = '';
        
        // Check if user is already logged in
        function checkLoginState() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                isLoggedIn = true;
                loadCart();
            }
        }
        
        // Mobile Menu Toggle
        mobileMenuBtn.addEventListener('click', () => {
            navLinks.classList.toggle('active');
        });
        
        // Event Listeners
        logoLink.addEventListener('click', (e) => {
            e.preventDefault();
            navigateTo('home');
        });

        for (let i = 0; i < homeLinks.length; i++) {
            homeLinks[i].addEventListener('click', (e) => {
                console.log("Clicked!!!")
                e.preventDefault();
                navigateTo('home');
            });
        }
        
        cartLink.addEventListener('click', (e) => {
            e.preventDefault();
            navigateTo('cart');
        });
        
        accountLink.addEventListener('click', (e) => {
            e.preventDefault();
            if (isLoggedIn) {
                navigateTo('account');
            } else {
                navigateTo('login');
            }
        });
        
        searchBtn.addEventListener('click', () => {
            searchTerm = searchInput.value.trim().toLowerCase();
            applyFilters();
            renderProducts();
        });
        
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchTerm = searchInput.value.trim().toLowerCase();
                applyFilters();
                renderProducts();
            }
        });
        
        // Navigation Function
        function navigateTo(page, params = {}) {
            currentPage = page;
            
            // Check if user is logged in for protected pages
            if (['cart', 'checkout', 'account'].includes(page) && !isLoggedIn) {
                showNotification('Please login to continue', 'error');
                currentPage = 'login';
            }
            
            // Close mobile menu if open
            navLinks.classList.remove('active');
            
            // Render the appropriate page
            switch (currentPage) {
                case 'home':
                    renderHomePage();
                    break;
                case 'login':
                    renderLoginPage();
                    break;
                case 'register':
                    renderRegisterPage();
                    break;
                case 'product':
                    renderProductDetailPage(params.productId);
                    break;
                case 'cart':
                    renderCartPage();
                    break;
                case 'checkout':
                    renderCheckoutPage();
                    break;
                case 'account':
                    renderAccountPage();
                    break;
                default:
                    renderHomePage();
            }
            
            // Scroll to top after navigation
            window.scrollTo(0, 0);
        }
        
        // Initialize the app on load
        window.addEventListener('load', () => {
            try {
                checkLoginState();
                initializeProducts();
                filteredProducts = [...products];
                navigateTo('home');
                updateCartCount();
            } catch (e) {
                console.error(e);
                navigateTo('home');
            }
        });
        
        // Initialize Products
        function initializeProducts() {
            const productNames = [
                "Classic T-Shirt", "Denim Jeans", "Running Shoes", "Leather Wallet", "Backpack",
                "Watch", "Wireless Headphones", "Sunglasses", "Laptop Sleeve", "Phone Case",
                "Water Bottle", "Hoodie", "Sneakers", "Baseball Cap", "Dress Shirt",
                "Belt", "Socks Pack", "Fitness Tracker", "Tablet Cover", "Winter Jacket"
            ];
            
            const descriptions = [
                "Made from 100% organic cotton for maximum comfort and breathability.",
                "Classic fit with durable material that gets better with age.",
                "Designed for optimal performance and comfort during long runs.",
                "Handcrafted with genuine leather and multiple card slots.",
                "Water-resistant with padded laptop compartment and multiple pockets.",
                "Precision timekeeping with elegant design for everyday wear.",
                "Premium sound quality with active noise cancellation.",
                "UV protection with polarized lenses and lightweight frame.",
                "Padded protection for your laptop with water-resistant exterior.",
                "Shockproof protection with slim profile design.",
                "Vacuum insulated to keep drinks hot or cold for hours.",
                "Warm and cozy with kangaroo pocket and adjustable hood.",
                "Street-style comfort with cushioned insoles.",
                "Adjustable strap for perfect fit with embroidered logo.",
                "Wrinkle-resistant fabric with modern slim fit.",
                "Genuine leather with classic buckle design.",
                "Pack of 5 comfortable crew socks in assorted colors.",
                "Tracks steps, heart rate, and sleep patterns with long battery life.",
                "Protective cover with smart sleep/wake function.",
                "Waterproof and insulated for extreme weather conditions."
            ];
            
            const categories = ["Apparel", "Footwear", "Accessories", "Electronics", "Sportswear"];
            
            const images = [
                "https://upload.wikimedia.org/wikipedia/commons/2/24/Blue_Tshirt.jpg",
                "https://upload.wikimedia.org/wikipedia/commons/d/d2/Jeans_for_men.jpg",
                "https://picsum.photos/seed/1/200/300",
                "https://picsum.photos/seed/2/200/300",
                "https://picsum.photos/seed/3/200/300",
                "https://picsum.photos/seed/4/200/300",
                "https://picsum.photos/seed/5/200/300",
                "https://picsum.photos/seed/6/200/300",
                "https://picsum.photos/seed/7/200/300",
                "https://picsum.photos/seed/8/200/300",
                "https://picsum.photos/seed/9/200/300",
                "https://picsum.photos/seed/10/200/300",
                "https://picsum.photos/seed/11/200/300",
                "https://picsum.photos/seed/12/200/300",
                "https://picsum.photos/seed/13/200/300",
                "https://picsum.photos/seed/14/200/300",
                "https://picsum.photos/seed/15/200/300",
                "https://picsum.photos/seed/16/200/300",
                "https://picsum.photos/seed/17/200/300",
                "https://picsum.photos/seed/20/200/300",
            ];

            products = [];
            for (let i = 0; i < 20; i++) {
                const id = i + 1;
                const name = productNames[i];
                const price = (Math.random() * 100 + 10).toFixed(2);
                const description = descriptions[i];
                const category = categories[Math.floor(Math.random() * categories.length)];
                const image = images[i];
                const rating = (Math.random() * 2 + 3).toFixed(1);
                const stock = Math.floor(Math.random() * 50) + 5;
                
                products.push({
                    id,
                    name,
                    price,
                    description,
                    category,
                    image,
                    rating,
                    stock
                });
            }

            filteredProducts = [...products];
            console.log("Products initialized:", products.length);
        }
        
        // Utility Functions
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        function updateCartCount() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCountElement.textContent = totalItems;
        }
        
        function getCart() {
            return cart;
        }
        
        function addToCart(productId, quantity = 1) {
            if (!isLoggedIn) {
                showNotification('Please login to add items to cart', 'error');
                navigateTo('login');
                return;
            }
            
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    image: product.image,
                    quantity
                });
            }
            
            updateCartCount();
            saveCart();
            showNotification(`${product.name} added to cart`);
        }
        
        function updateCartItem(productId, quantity) {
            const index = cart.findIndex(item => item.id === productId);
            if (index === -1) return;
            
            if (quantity <= 0) {
                cart.splice(index, 1);
            } else {
                cart[index].quantity = quantity;
            }
            
            updateCartCount();
            saveCart();
            
            if (currentPage === 'cart') {
                renderCartPage();
            }
        }
        
        function removeCartItem(productId) {
            const index = cart.findIndex(item => item.id === productId);
            if (index === -1) return;
            
            const productName = cart[index].name;
            cart.splice(index, 1);
            
            updateCartCount();
            saveCart();
            showNotification(`${productName} removed from cart`);
            
            if (currentPage === 'cart') {
                renderCartPage();
            }
        }
        
        function calculateCartTotal() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = subtotal * 0.12;
            const deliveryCharge = subtotal > 0 ? 5.99 : 0;
            const total = subtotal + tax + deliveryCharge;
            
            return {
                subtotal: parseFloat(subtotal.toFixed(2)),
                tax: parseFloat(tax.toFixed(2)),
                deliveryCharge: parseFloat(deliveryCharge.toFixed(2)),
                total: parseFloat(total.toFixed(2))
            };
        }
        
        function saveCart() {
            if (isLoggedIn && currentUser) {
                localStorage.setItem(`cart_${currentUser.username}`, JSON.stringify(cart));
            }
        }
        
        function loadCart() {
            if (isLoggedIn && currentUser) {
                const savedCart = localStorage.getItem(`cart_${currentUser.username}`);
                if (savedCart) {
                    cart = JSON.parse(savedCart);
                    updateCartCount();
                }
            }
        }
        
        function clearCart() {
            cart = [];
            updateCartCount();
            saveCart();
        }
        
        function applyFilters() {
            let filtered = [...products];

            // Apply category filters
            const selectedCategories = Array.from(document.querySelectorAll('.category-filter:checked'))
                .map(checkbox => checkbox.value);
            
            if (selectedCategories.length > 0) {
                filtered = filtered.filter(p => selectedCategories.includes(p.category));
            }

            // Apply price range filter
            const minPrice = parseFloat(document.getElementById('min-price')?.value) || 0;
            const maxPrice = parseFloat(document.getElementById('max-price')?.value) || Infinity;
            filtered = filtered.filter(p => 
                parseFloat(p.price) >= minPrice && parseFloat(p.price) <= maxPrice
            );

            // Apply search filter
            if (searchTerm) {
                filtered = filtered.filter(p => 
                    p.name.toLowerCase().includes(searchTerm) || 
                    p.description.toLowerCase().includes(searchTerm) ||
                    p.category.toLowerCase().includes(searchTerm)
                );
            }

            filteredProducts = filtered;
            currentProductPage = 1;
        }
        
        // Page Rendering Functions
        function renderHomePage() {
            console.log("Rendering home page");
            
            mainContent.innerHTML = `
                <div class="products-container">
                    <h1>Product Catalog</h1>
                    
                    <div class="filters">
                        <div class="filter-group">
                            <h3 class="filter-title">Categories</h3>
                            <div class="filter-options">
                                <label><input type="checkbox" class="category-filter" value="Apparel"> Apparel</label>
                                <label><input type="checkbox" class="category-filter" value="Footwear"> Footwear</label>
                                <label><input type="checkbox" class="category-filter" value="Accessories"> Accessories</label>
                                <label><input type="checkbox" class="category-filter" value="Electronics"> Electronics</label>
                                <label><input type="checkbox" class="category-filter" value="Sportswear"> Sportswear</label>
                            </div>
                        </div>
                        
                        <div class="filter-group">
                            <h3 class="filter-title">Price Range</h3>
                            <div class="price-range">
                                <input type="number" class="price-input" id="min-price" placeholder="Min">
                                <input type="number" class="price-input" id="max-price" placeholder="Max">
                                <button class="btn btn-primary" id="apply-price-filter">Apply</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="products-grid" id="products-grid">
                        <div class="loading">Loading products...</div>
                    </div>
                    
                    <div class="pagination" id="pagination"></div>
                </div>
            `;
            
            // Ensure products are initialized
            if (products.length === 0) {
                console.log("Products not initialized yet, initializing...");
                initializeProducts();
            }

            // Render products
            renderProducts();

            // Add event listeners for filters
            document.querySelectorAll('.category-filter').forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    applyFilters();
                    renderProducts();
                });
            });

            document.getElementById('apply-price-filter').addEventListener('click', () => {
                const minPrice = parseFloat(document.getElementById('min-price').value) || 0;
                const maxPrice = parseFloat(document.getElementById('max-price').value) || Infinity;
                
                filteredProducts = products.filter(p => 
                    parseFloat(p.price) >= minPrice && parseFloat(p.price) <= maxPrice
                );
                applyFilters();
                renderProducts();
            });
        }
        
        function renderProducts() {
            const productsGrid = document.getElementById('products-grid');
            const paginationContainer = document.getElementById('pagination');
            
            if (!productsGrid) {
                console.error("Products grid not found");
                return;
            }

            console.log("Rendering products. Filtered products:", filteredProducts.length);

            // Calculate pagination
            const totalProducts = filteredProducts.length;
            const totalPages = Math.ceil(totalProducts / productsPerPage);
            const startIndex = (currentProductPage - 1) * productsPerPage;
            const endIndex = Math.min(startIndex + productsPerPage, totalProducts);
            
            const currentProducts = filteredProducts.slice(startIndex, endIndex);

            console.log("Current page products:", currentProducts.length);

            // Render products
            if (currentProducts.length === 0) {
                productsGrid.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon"><i class="fas fa-search"></i></div>
                        <div class="empty-message">No products found</div>
                        <button class="btn btn-primary" id="clear-filters-btn">Clear Filters</button>
                    </div>
                `;
                
                document.getElementById('clear-filters-btn').addEventListener('click', () => {
                    searchInput.value = '';
                    searchTerm = '';
                    document.querySelectorAll('.category-filter').forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    document.getElementById('min-price').value = '';
                    document.getElementById('max-price').value = '';
                    
                    filteredProducts = [...products];
                    renderProducts();
                });
            } else {
                productsGrid.innerHTML = currentProducts.map(product => `
                    <div class="product-card" data-product-id="${product.id}">
                        <div class="product-image">
                            <img src="${product.image}" alt="${product.name}" 
                                 onerror="this.onerror=null;this.src='https://via.placeholder.com/180';">
                        </div>
                        <div class="product-info">
                            <div class="product-name">${product.name}</div>
                            <div class="product-price">$${product.price}</div>
                            <div class="product-actions">
                                <button class="btn btn-primary view-product-btn" data-product-id="${product.id}">View</button>
                                <button class="btn btn-secondary add-to-cart-btn" data-product-id="${product.id}">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                `).join('');

                // Add event listeners to product cards
                document.querySelectorAll('.view-product-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const productId = parseInt(e.target.dataset.productId);
                        navigateTo('product', { productId });
                    });
                });

                document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const productId = parseInt(e.target.dataset.productId);
                        addToCart(productId);
                    });
                });
            }

            // Render pagination
            paginationContainer.innerHTML = '';
            if (totalPages > 1) {
                let paginationHTML = `
                    <div class="page-item">
                        <a href="#" class="page-link ${currentProductPage === 1 ? 'disabled' : ''}" 
                           data-page="${currentProductPage - 1}" ${currentProductPage === 1 ? 'aria-disabled="true"' : ''}>
                            <i class="fas fa-chevron-left"></i>
                        </a>
                    </div>
                `;

                const startPage = Math.max(1, currentProductPage - 2);
                const endPage = Math.min(totalPages, startPage + 4);

                for (let i = startPage; i <= endPage; i++) {
                    paginationHTML += `
                        <div class="page-item">
                            <a href="#" class="page-link ${i === currentProductPage ? 'active' : ''}" data-page="${i}">${i}</a>
                        </div>
                    `;
                }

                paginationHTML += `
                    <div class="page-item">
                        <a href="#" class="page-link ${currentProductPage === totalPages ? 'disabled' : ''}" 
                           data-page="${currentProductPage + 1}" ${currentProductPage === totalPages ? 'aria-disabled="true"' : ''}>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </div>
                `;

                paginationContainer.innerHTML = paginationHTML;

                document.querySelectorAll('.page-link').forEach(link => {
                    if (!link.classList.contains('disabled')) {
                        link.addEventListener('click', (e) => {
                            e.preventDefault();
                            currentProductPage = parseInt(e.target.closest('.page-link').dataset.page);
                            renderProducts();
                            window.scrollTo(0, 0);
                        });
                    }
                });
            }
        }
        
        function renderProductDetailPage(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) {
                navigateTo('home');
                return;
            }
            
            mainContent.innerHTML = `
                <div class="product-detail">
                    <button class="btn btn-secondary" id="home-link"> &lt;</button>
                    <div class="product-detail-image">
                        <img src="${product.image}" alt="${product.name}">
                    </div>
                    <div class="product-detail-info">
                        <h1 class="product-detail-name">${product.name}</h1>
                        <div class="product-detail-price">$${product.price}</div>
                        <div class="product-detail-description">${product.description}</div>
                        <div class="product-detail-meta">
                            <div class="meta-item">
                                <span class="meta-label">Category:</span>
                                <span>${product.category}</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Rating:</span>
                                <span>${product.rating} <i class="fas fa-star" style="color: gold;"></i></span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">In Stock:</span>
                                <span>${product.stock} items</span>
                            </div>
                        </div>
                        <div class="product-detail-actions">
                            <div class="quantity-control">
                                <button class="quantity-btn" id="decrease-qty">-</button>
                                <input type="number" class="quantity-input" id="product-qty" value="1" min="1" max="${product.stock}">
                                <button class="quantity-btn" id="increase-qty">+</button>
                            </div>
                            <button class="btn btn-primary" id="add-to-cart-detail">Add to Cart</button>
                        </div>
                    </div>
                </div>
            `;
            
            // Add event listeners
            const quantityInput = document.getElementById('product-qty');
            
            document.getElementById('decrease-qty').addEventListener('click', () => {
                if (parseInt(quantityInput.value) > 1) {
                    quantityInput.value = parseInt(quantityInput.value) - 1;
                }
            });
            
            document.getElementById('increase-qty').addEventListener('click', () => {
                if (parseInt(quantityInput.value) < product.stock) {
                    quantityInput.value = parseInt(quantityInput.value) + 1;
                }
            });
            
            document.getElementById('add-to-cart-detail').addEventListener('click', () => {
                const quantity = parseInt(quantityInput.value);
                addToCart(product.id, quantity);
            });

            document.getElementById('home-link').addEventListener('click', (e) => {
                e.preventDefault();
                navigateTo('home')
            });
        }
        
        function renderCartPage() {
            const cartItems = getCart();
            const cartTotal = calculateCartTotal();
            
            mainContent.innerHTML = `
                <div class="cart-container">
                    <h1>Shopping Cart</h1>
                    
                    ${cartItems.length === 0 ? `
                        <div class="empty-state">
                            <div class="empty-icon"><i class="fas fa-shopping-cart"></i></div>
                            <div class="empty-message">Your cart is empty</div>
                            <a href="#" class="btn btn-primary" id="continue-shopping">Continue Shopping</a>
                        </div>
                    ` : `
                        <div class="cart-items">
                            ${cartItems.map(item => `
                                <div class="cart-item" data-product-id="${item.id}">
                                    <div class="cart-item-image">
                                        <img src="${item.image}" alt="${item.name}">
                                    </div>
                                    <div class="cart-item-details">
                                        <div class="cart-item-name">${item.name}</div>
                                        <div class="cart-item-price">$${item.price}</div>
                                    </div>
                                    <div class="cart-item-actions">
                                        <div class="quantity-control">
                                            <button class="quantity-btn decrease-cart-qty" data-product-id="${item.id}">-</button>
                                            <input type="number" class="quantity-input cart-qty" data-product-id="${item.id}" value="${item.quantity}" min="1">
                                            <button class="quantity-btn increase-cart-qty" data-product-id="${item.id}">+</button>
                                        </div>
                                        <button class="btn btn-danger remove-cart-item" data-product-id="${item.id}">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="cart-summary">
                            <div class="summary-item">
                                <span>Subtotal</span>
                                <span>$${cartTotal.subtotal}</span>
                            </div>
                            <div class="summary-item">
                                <span>Tax (12%)</span>
                                <span>$${cartTotal.tax}</span>
                            </div>
                            <div class="summary-item">
                                <span>Delivery Charge</span>
                                <span>$${cartTotal.deliveryCharge}</span>
                            </div>
                            <div class="summary-item total">
                                <span>Total</span>
                                <span>$${cartTotal.total}</span>
                            </div>
                            <button class="btn btn-primary" id="checkout-btn" style="width: 100%; margin-top: 15px;">Proceed to Checkout</button>
                        </div>
                    `}
                </div>
            `;
            
            // Add event listeners
            if (cartItems.length === 0) {
                document.getElementById('continue-shopping').addEventListener('click', (e) => {
                    e.preventDefault();
                    navigateTo('home');
                });
            } else {
                document.querySelectorAll('.decrease-cart-qty').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const productId = parseInt(e.target.dataset.productId);
                        const item = cartItems.find(item => item.id === productId);
                        if (item && item.quantity > 1) {
                            updateCartItem(productId, item.quantity - 1);
                        }
                    });
                });
                
                document.querySelectorAll('.increase-cart-qty').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const productId = parseInt(e.target.dataset.productId);
                        const item = cartItems.find(item => item.id === productId);
                        if (item) {
                            updateCartItem(productId, item.quantity + 1);
                        }
                    });
                });
                
                document.querySelectorAll('.cart-qty').forEach(input => {
                    input.addEventListener('change', (e) => {
                        const productId = parseInt(e.target.dataset.productId);
                        const quantity = parseInt(e.target.value);
                        if (quantity > 0) {
                            updateCartItem(productId, quantity);
                        } else {
                            e.target.value = 1;
                            updateCartItem(productId, 1);
                        }
                    });
                });
                
                document.querySelectorAll('.remove-cart-item').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const productId = parseInt(e.target.closest('.remove-cart-item').dataset.productId);
                        removeCartItem(productId);
                    });
                });
                
                document.getElementById('checkout-btn').addEventListener('click', () => {
                    navigateTo('checkout');
                });
            }
        }
        
        function renderCheckoutPage() {
            const cartItems = getCart();
            if (cartItems.length === 0) {
                navigateTo('cart');
                return;
            }
            
            const cartTotal = calculateCartTotal();
            
            mainContent.innerHTML = `
                <div class="checkout-container">
                    <div class="checkout-form">
                        <h1>Checkout</h1>
                        
                        <div class="checkout-form-section">
                            <h2 class="section-title">Shipping Information</h2>
                            <div class="form-group">
                                <label for="full-name">Full Name</label>
                                <input type="text" id="full-name" required>
                            </div>
                            <div class="form-group">
                                <label for="address">Address</label>
                                <input type="text" id="address" required>
                            </div>
                            <div class="form-group">
                                <label for="city">City</label>
                                <input type="text" id="city" required>
                            </div>
                            <div class="form-group">
                                <label for="zip">ZIP Code</label>
                                <input type="text" id="zip" required>
                            </div>
                            <div class="form-group">
                                <label for="country">Country</label>
                                <input type="text" id="country" required>
                            </div>
                        </div>
                        
                        <div class="checkout-form-section">
                            <h2 class="section-title">Payment Information</h2>
                            <div class="form-group">
                                <label for="card-number">Card Number</label>
                                <input type="text" id="card-number" placeholder="XXXX-XXXX-XXXX-XXXX" required>
                            </div>
                            <div class="form-group">
                                <label for="card-name">Name on Card</label>
                                <input type="text" id="card-name" required>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <div class="form-group" style="flex: 1;">
                                    <label for="expiry">Expiry Date</label>
                                    <input type="text" id="expiry" placeholder="MM/YY" required>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label for="cvv">CVV</label>
                                    <input type="text" id="cvv" placeholder="123" required>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="checkout-summary">
                        <h2 class="section-title">Order Summary</h2>
                        <div class="summary-items">
                            ${cartItems.map(item => `
                                <div class="summary-item">
                                    <span>${item.quantity} x ${item.name}</span>
                                    <span>$${(item.price * item.quantity).toFixed(2)}</span>
                                </div>
                            `).join('')}
                        </div>
                        <div class="summary-item">
                            <span>Subtotal</span>
                            <span>$${cartTotal.subtotal}</span>
                        </div>
                        <div class="summary-item">
                            <span>Tax (12%)</span>
                            <span>$${cartTotal.tax}</span>
                        </div>
                        <div class="summary-item">
                            <span>Delivery Charge</span>
                            <span>$${cartTotal.deliveryCharge}</span>
                        </div>
                        <div class="summary-item total">
                            <span>Total</span>
                            <span>$${cartTotal.total}</span>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <button class="btn btn-primary" id="place-order-btn" style="width: 100%;">Place Order</button>
                            <button class="btn btn-danger" id="cancel-order-btn" style="width: 100%; margin-top: 10px;">Cancel Order</button>
                        </div>
                    </div>
                </div>
            `;
            
            // Add event listeners
            document.getElementById('place-order-btn').addEventListener('click', () => {
                const requiredFields = document.querySelectorAll('.checkout-form input[required]');
                let allFieldsFilled = true;
                
                requiredFields.forEach(field => {
                    if (!field.value.trim()) {
                        field.style.borderColor = 'red';
                        allFieldsFilled = false;
                    } else {
                        field.style.borderColor = '';
                    }
                });
                
                if (allFieldsFilled) {
                    const isSuccess = Math.random() > 0.3;
                    
                    if (isSuccess) {
                        mainContent.innerHTML = `
                            <div class="empty-state">
                                <div class="empty-icon" style="color: var(--secondary-color);"><i class="fas fa-check-circle"></i></div>
                                <div class="empty-message" style="color: var(--secondary-color);">Your order has been placed successfully!</div>
                                <div style="margin: 20px 0;">Your order number is: #${Math.floor(Math.random() * 1000000)}</div>
                                <a href="#" class="btn btn-primary" id="continue-shopping-success">Continue Shopping</a>
                            </div>
                        `;
                        
                        clearCart();
                        
                        document.getElementById('continue-shopping-success').addEventListener('click', (e) => {
                            e.preventDefault();
                            navigateTo('home');
                        });
                    } else {
                        mainContent.innerHTML = `
                            <div class="empty-state">
                                <div class="empty-icon" style="color: var(--danger-color);"><i class="fas fa-times-circle"></i></div>
                                <div class="empty-message" style="color: var(--danger-color);">Payment failed!</div>
                                <div style="margin: 20px 0;">Please try again or use a different payment method.</div>
                                <a href="#" class="btn btn-primary" id="try-again">Try Again</a>
                            </div>
                        `;
                        
                        document.getElementById('try-again').addEventListener('click', (e) => {
                            e.preventDefault();
                            navigateTo('checkout');
                        });
                    }
                } else {
                    showNotification('Please fill in all required fields', 'error');
                }
            });
            
            document.getElementById('cancel-order-btn').addEventListener('click', () => {
                navigateTo('cart');
            });
        }
        
        function renderLoginPage() {
            mainContent.innerHTML = `
                <div class="auth-container">
                    <h1 class="auth-title">Login</h1>
                    
                    <div class="auth-error" id="login-error"></div>
                    
                    <form id="login-form">
                        <div class="form-group">
                            <label for="username">Username</label>
                            <input type="text" id="username" required>
                        </div>
                        <div class="form-group">
                            <label for="password">Password</label>
                            <input type="password" id="password" required>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">Login</button>
                    </form>
                    
                    <div class="auth-links">
                        <p>Don't have an account? <a href="#" id="register-link">Register</a></p>
                    </div>
                </div>
            `;
            
            document.getElementById('login-form').addEventListener('submit', (e) => {
                e.preventDefault();
                
                const username = document.getElementById('username').value.trim();
                const password = document.getElementById('password').value.trim();
                
                if (username === 'admin' && password === 'admin') {
                    isLoggedIn = true;
                    currentUser = { username: 'admin', name: 'Admin User' };
                    
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    loadCart();
                    
                    showNotification('Login successful');
                    navigateTo('home');
                } else {
                    const loginError = document.getElementById('login-error');
                    loginError.textContent = 'Invalid username or password';
                    loginError.style.display = 'block';
                }
            });
            
            document.getElementById('register-link').addEventListener('click', (e) => {
                e.preventDefault();
                navigateTo('register');
            });
        }
        
        function renderRegisterPage() {
            mainContent.innerHTML = `
                <div class="auth-container">
                    <h1 class="auth-title">Register</h1>
                    
                    <div class="auth-error" id="register-error"></div>
                    
                    <form id="register-form">
                        <div class="form-group">
                            <label for="full-name">Full Name</label>
                            <input type="text" id="full-name" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" required>
                        </div>
                        <div class="form-group">
                            <label for="reg-username">Username</label>
                            <input type="text" id="reg-username" required>
                        </div>
                        <div class="form-group">
                            <label for="reg-password">Password</label>
                            <input type="password" id="reg-password" required>
                        </div>
                        <div class="form-group">
                            <label for="confirm-password">Confirm Password</label>
                            <input type="password" id="confirm-password" required>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">Register</button>
                    </form>
                    
                    <div class="auth-links">
                        <p>Already have an account? <a href="#" id="login-link">Login</a></p>
                    </div>
                </div>
            `;
            
            document.getElementById('register-form').addEventListener('submit', (e) => {
                e.preventDefault();
                
                const fullName = document.getElementById('full-name').value.trim();
                const email = document.getElementById('email').value.trim();
                const username = document.getElementById('reg-username').value.trim();
                const password = document.getElementById('reg-password').value.trim();
                const confirmPassword = document.getElementById('confirm-password').value.trim();
                
                const registerError = document.getElementById('register-error');
                
                const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailPattern.test(email)) {
                    registerError.textContent = 'Please enter a valid email address';
                    registerError.style.display = 'block';
                    return;
                }
                
                if (password !== confirmPassword) {
                    registerError.textContent = 'Passwords do not match';
                    registerError.style.display = 'block';
                    return;
                }
                
                if (password.length < 6) {
                    registerError.textContent = 'Password must be at least 6 characters long';
                    registerError.style.display = 'block';
                    return;
                }
                
                isLoggedIn = true;
                currentUser = { username, name: fullName, email };
                
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                showNotification('Registration successful');
                navigateTo('home');
            });
            
            document.getElementById('login-link').addEventListener('click', (e) => {
                e.preventDefault();
                navigateTo('login');
            });
        }
        
        function renderAccountPage() {
            if (!isLoggedIn || !currentUser) {
                navigateTo('login');
                return;
            }
            
            mainContent.innerHTML = `
                <div class="auth-container" style="max-width: 600px;">
                    <h1 class="auth-title">My Account</h1>
                    
                    <div style="margin-bottom: 30px;">
                        <h2 style="margin-bottom: 15px;">Account Information</h2>
                        <p><strong>Name:</strong> ${currentUser.name || 'Admin User'}</p>
                        <p><strong>Username:</strong> ${currentUser.username}</p>
                        <p><strong>Email:</strong> ${currentUser.email || 'admin@example.com'}</p>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <h2 style="margin-bottom: 15px;">Order History</h2>
                        <p>No orders yet.</p>
                    </div>
                    
                    <button class="btn btn-danger" id="logout-btn" style="width: 100%;">Logout</button>
                </div>
            `;
            
            document.getElementById('logout-btn').addEventListener('click', () => {
                isLoggedIn = false;
                currentUser = null;
                cart = [];
                
                localStorage.removeItem('currentUser');
                localStorage.removeItem(`cart_admin`);
                
                updateCartCount();
                showNotification('Logged out successfully');
                navigateTo('login');
            });
        }
    </script>
</body>
</html>